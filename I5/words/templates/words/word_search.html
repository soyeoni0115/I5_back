<!-- 
디버깅용 임시 파일, 삭제해도 상관 없음, 따로 알림만 주세요

이 파일은 words/templates/words/word_search.html 입니다.
/words/dictionary/ URL 접속 시 이 화면이 보입니다.
-->

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>단어 검색 테스트</title>
    <style> 
        body { font-family: sans-serif; margin: 20px; }
        .search-box { margin-bottom: 20px; }
        .result-box { border: 1px solid #ccc; padding: 15px; border-radius: 5px; }
        .error { color: red; font-weight: bold; }
        .definitions { margin-left: 20px; }
    </style>
</head>
<body>
    <h1>단어 검색 테스트 화면</h1>

    <!-- 1. 단어 검색 폼 (GET 방식) -->
    <div class="search-box">
        <form action="{% url 'words:word_search' %}" method="GET">
            <input type="text" name="query" value="{{ query|default:'' }}" placeholder="단어를 입력하세요 (예: 나무)">
            <button type="submit">검색</button>
        </form>
    </div>

    <!-- 2. 검색 결과 또는 에러 표시 -->
    {% if error_message %}
        <div class="error">
            <p>오류 발생: {{ error_message }}</p>
        </div>
    {% endif %}

    {% if word %}
            <h2>{{ word.text }}</h2>
            
         
            <div class="result-box">
            <h2>{{ word.text }}</h2>
            
            <!-- 3. 테스트용 정보 표시 -->
            <p>
                <strong>검색 횟수:</strong> {{ word.search_count }} <br>
                <strong>자주 찾는 단어:</strong> {{ word.is_frequent }}
            </p>

            <!-- 4. 뜻 목록 표시 -->
            <div class="definitions">
                <strong>뜻:</strong>
                <ul>
                {% for definition in word.definitions.all %}
                    <li>{{ definition.text }}</li>
                {% empty %}
                    <li>API에서 가져온 뜻이 없습니다.</li>
                {% endfor %}
                </ul>
            </div>

            <!-- 5. 북마크 토글 폼 (POST 방식) -->
            <!-- 이 기능은 로그인이 되어 있어야 작동합니다. -->
            {% if user.is_authenticated %}
                   <form action="{% url 'words:toggle_bookmark' word.id %}" method="POST">
                    {% csrf_token %}
                     <button type="submit">
                    {% if is_bookmarked %}
                        ★ 북마크 취소
                    {% else %}
                        ☆ 북마크
                    {% endif %}
                </button>
                </form>
            {% else %}
                <p><small>로그인 시 북마크할 수 있습니다.</small></p>
            {% endif %}
        </div>

    {% elif query and not error_message %}
        <p>검색 결과가 없습니다.</p>
    {% endif %}

</body>
</html>